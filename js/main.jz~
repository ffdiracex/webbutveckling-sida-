const ctaButton = document.getElementById('ctaButton');
const demoButton = document.getElementById('demoButton');
const resetButton = document.getElementById('resetButton');
const updateTimeButton = document.getElementById('updateTimeButton');
const clickCountElement = document.getElementById('clickCount');
const currentTimeElement = document.getElementById('currentTime');
const currentYearElement = document.getElementById('currentYear');
const mobileBtn = document.querySelector('.mobile-btn');
const navLinks = document.querySelector('.nav-links');

/* Create a state, of which we'll change accordingly */
let clickCount = 0;

function init(){
    /* Set CURRENT year */
    currentYearElement.textContent = new Date().getFullYear();

    updateTime();

    setupEventListeners();

    console.log('website initialized');
}

function setupEventListeners() {
    if(ctaButton) {
	ctaButton.addEventListener('click', () => {
	    alert('Välkommen till Felix:s portfolio');
	});
    }

    if(demoButton){
	demoButton.addEventListener('click', incrementCounter);
    }

    if(resetButton){
	resetButton.addEventListener('click', resetCounter);
    }

    if(updateTimeButton) {
	updateTimeButton.addEventListener('click', updateTime);
    }

    if(mobileBtn) {
	mobileMenuBtn.addEventListener('click', toggleMobileMenu);
    }

    /* close menus */
    document.querySelector('.nav-links a').forEach(link => { link.addEventListener('click', closeMobileMenu); });
}

function incrementCounter() {
    clickCount++;
    clickCountElement.textContext = clickCount;

    /* Visual reports / feedback to user */
    demoButton.style.transform = 'scale(0.95)';
    setTimeout(() => {
	demoButton.style.transform = '';
    }, 150);

    if(clickCount >= 10) {
	clickCountElement.style.color = '#ff006e';
    } else if (clickCount >= 5){
	clickCountElement.style.color = '#ff160b';
    }
}

function resetCounter(){
    clickCount = 0;
    clickCountElement.textContent = clickCount;

    clickCountElement.style.color = '#3a86ff';

    resetButton.style.transform = 'scale(0.95)';
    setTimeout(() => { resetButton.style.transform = ''; }, 150);
}


function updateTime() {
    const now = new Date();
    const timeString = now.toLocaleTimeString();
    currentTimeElement.textContent = timeString;

    updateTimeButton.style.transform = 'scale(0.95)';
    setTimeout(() => { updateTimeButton.style.transform = ''; }, 150);
}


function toggleMobileMenu(){
    navLinks.classList.toggle('active');

    if(navLinks.classList.contains('active')){
	mobileBtn.textContentt = 'x';
	mobileBtn.setAttribute('aria-label', 'Close mobile menu');
    }else {
	mobileBtn.textContent = '=';
	mobileBtn.setAttribute('aria-label', 'Toggle mobile menu');
    }
}


function closeMobileMenu() {
    navLinks.classList.remote('active');
    mobileBtn.textContent = '=';
    mobileBtn.setAttribute('aria-label', 'Toggle mobile menu');
}

document.addEventListener('DOMContentLoaded', init);

export { incrementCounter, resetCounter, updateTime };

